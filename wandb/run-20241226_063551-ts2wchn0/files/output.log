GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Process Name: MainProcess, PID: 125707, DataIndex: 300
Process Name: MainProcess, PID: 125707, DataIndex: 600
Process Name: MainProcess, PID: 125707, DataIndex: 900
Process Name: MainProcess, PID: 125707, DataIndex: 1200
Process Name: MainProcess, PID: 125707, DataIndex: 1500
Process Name: MainProcess, PID: 125707, DataIndex: 1800
Process Name: MainProcess, PID: 125707, DataIndex: 2100
Process Name: MainProcess, PID: 125707, DataIndex: 2400
Process Name: MainProcess, PID: 125707, DataIndex: 2700
Process Name: MainProcess, PID: 125707, DataIndex: 3000
Process Name: MainProcess, PID: 125707, DataIndex: 3300
Process Name: MainProcess, PID: 125707, DataIndex: 3600
Process Name: MainProcess, PID: 125707, DataIndex: 3900
Process Name: MainProcess, PID: 125707, DataIndex: 4200
Process Name: MainProcess, PID: 125707, DataIndex: 4500
Process Name: MainProcess, PID: 125707, DataIndex: 4800
Process Name: MainProcess, PID: 125707, DataIndex: 5100
Process Name: MainProcess, PID: 125707, DataIndex: 5400
Process Name: MainProcess, PID: 125707, DataIndex: 5700
Process Name: MainProcess, PID: 125707, DataIndex: 6000
Process Name: MainProcess, PID: 125707, DataIndex: 6300
Process Name: MainProcess, PID: 125707, DataIndex: 6600
Process Name: MainProcess, PID: 125707, DataIndex: 6900
Process Name: MainProcess, PID: 125707, DataIndex: 7200
Process Name: MainProcess, PID: 125707, DataIndex: 7500
Process Name: MainProcess, PID: 125707, DataIndex: 7800
Process Name: MainProcess, PID: 125707, DataIndex: 8100
Process Name: MainProcess, PID: 125707, DataIndex: 8400
Process Name: MainProcess, PID: 125707, DataIndex: 8700
/home/siyao/Apps/anaconda3/envs/miniGrid/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:611: UserWarning: Checkpoint directory /home/siyao/project/rlPractice/DomainGeneralization/modelBased/gen/models/ckpt exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/siyao/Apps/anaconda3/envs/miniGrid/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
  | Name          | Type          | Params
------------------------------------------------
0 | generator     | Generator     | 826 K
1 | discriminator | Discriminator | 78.0 K
------------------------------------------------
904 K     Trainable params
0         Non-trainable params
904 K     Total params
3.619     Total estimated model params size (MB)
/home/siyao/Apps/anaconda3/envs/miniGrid/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py:1927: PossibleUserWarning: The number of training batches (36) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
Process Name: MainProcess, PID: 125707, DataIndex: 9000
Process Name: MainProcess, PID: 125707, DataIndex: 9300
Process Name: MainProcess, PID: 125707, DataIndex: 9600
Process Name: MainProcess, PID: 125707, DataIndex: 9900
Epoch 0:  75%|█████████████████████████████████████████████████████████████████████████████▎                         | 30/40 [00:00<00:00, 44.70it/s, loss=1.12, v_num=chn0, g_loss_step=2.100, d_loss_step=0.418]
Metric g_loss improved. New best score: 1.235
Epoch 0, global step 72: 'g_loss' reached 1.23474 (best 1.23474), saving model to '/home/siyao/project/rlPractice/DomainGeneralization/modelBased/gen/models/ckpt/gen-epoch=00-g_loss=1.2347.ckpt' as top 1

Epoch 3:   0%|                                    | 0/40 [00:00<?, ?it/s, loss=1.49, v_num=chn0, g_loss_step=2.570, d_loss_step=0.285, val_g_loss=1.960, val_d_loss=0.299, g_loss_epoch=2.560, d_loss_epoch=0.301]
Epoch 2, global step 216: 'g_loss' was not in top 1
Epoch 3, global step 288: 'g_loss' was not in top 1
Epoch 5:  90%|████████████████████████▎  | 36/40 [00:00<00:00, 60.62it/s, loss=1.14, v_num=chn0, g_loss_step=1.300, d_loss_step=0.904, val_g_loss=0.353, val_d_loss=1.920, g_loss_epoch=2.210, d_loss_epoch=0.580]

Validation: 0it [00:00, ?it/s]
Metric g_loss improved by 0.082 >= min_delta = 0.01. New best score: 1.152
Epoch 5, global step 432: 'g_loss' reached 1.15234 (best 1.15234), saving model to '/home/siyao/project/rlPractice/DomainGeneralization/modelBased/gen/models/ckpt/gen-epoch=05-g_loss=1.1523.ckpt' as top 1
Epoch 6, global step 504: 'g_loss' was not in top 1

Epoch 11:  18%|████▉                       | 7/40 [00:00<00:01, 30.74it/s, loss=1.1, v_num=chn0, g_loss_step=1.250, d_loss_step=1.070, val_g_loss=1.310, val_d_loss=0.686, g_loss_epoch=1.300, d_loss_epoch=1.020]
Epoch 8, global step 648: 'g_loss' was not in top 1

Epoch 13:  10%|██▋                        | 4/40 [00:00<00:01, 20.23it/s, loss=1.25, v_num=chn0, g_loss_step=1.550, d_loss_step=0.856, val_g_loss=1.510, val_d_loss=0.717, g_loss_epoch=1.190, d_loss_epoch=1.060]
Epoch 10, global step 792: 'g_loss' was not in top 1
Epoch 11, global step 864: 'g_loss' was not in top 1
Epoch 15: 100%|██████████████████████████| 40/40 [00:00<00:00, 55.67it/s, loss=1.09, v_num=chn0, g_loss_step=0.675, d_loss_step=1.470, val_g_loss=0.460, val_d_loss=1.710, g_loss_epoch=0.506, d_loss_epoch=1.890]
Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 350.71it/s]
Epoch 13, global step 1008: 'g_loss' was not in top 1
Metric g_loss improved by 0.646 >= min_delta = 0.01. New best score: 0.506

Epoch 14, global step 1080: 'g_loss' reached 0.50597 (best 0.50597), saving model to '/home/siyao/project/rlPractice/DomainGeneralization/modelBased/gen/models/ckpt/gen-epoch=14-g_loss=0.5060.ckpt' as top 1
Epoch 15, global step 1152: 'g_loss' was not in top 1
Epoch 16, global step 1224: 'g_loss' was not in top 1

Epoch 21:  55%|██████████████▎           | 22/40 [00:00<00:00, 57.63it/s, loss=1.14, v_num=chn0, g_loss_step=0.541, d_loss_step=1.740, val_g_loss=0.630, val_d_loss=1.590, g_loss_epoch=0.634, d_loss_epoch=1.560]
Epoch 18, global step 1368: 'g_loss' was not in top 1

Epoch 23:  62%|████████████████▎         | 25/40 [00:00<00:00, 51.44it/s, loss=1.05, v_num=chn0, g_loss_step=0.766, d_loss_step=1.330, val_g_loss=0.772, val_d_loss=1.360, g_loss_epoch=0.795, d_loss_epoch=1.360]
Epoch 20, global step 1512: 'g_loss' was not in top 1
Epoch 21, global step 1584: 'g_loss' was not in top 1

Epoch 26:  12%|███▍                       | 5/40 [00:00<00:01, 20.87it/s, loss=1.05, v_num=chn0, g_loss_step=0.541, d_loss_step=1.560, val_g_loss=0.558, val_d_loss=1.490, g_loss_epoch=0.655, d_loss_epoch=1.420]
Epoch 23, global step 1728: 'g_loss' was not in top 1
Epoch 24, global step 1800: 'g_loss' was not in top 1
Epoch 28:  90%|███████████████████████▍  | 36/40 [00:00<00:00, 69.37it/s, loss=1.04, v_num=chn0, g_loss_step=0.661, d_loss_step=1.400, val_g_loss=0.637, val_d_loss=1.420, g_loss_epoch=0.597, d_loss_epoch=1.490]
Validation: 0it [00:00, ?it/s]
Epoch 26, global step 1944: 'g_loss' was not in top 1

Epoch 27, global step 2016: 'g_loss' was not in top 1
Epoch 28, global step 2088: 'g_loss' was not in top 1
Epoch 29, global step 2160: 'g_loss' was not in top 1
Epoch 30, global step 2232: 'g_loss' was not in top 1
Epoch 31, global step 2304: 'g_loss' was not in top 1

Epoch 34:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.03, v_num=chn0, g_loss_step=0.675, d_loss_step=1.430, val_g_loss=0.702, val_d_loss=1.320, g_loss_epoch=0.690, d_loss_epoch=1.380]
Epoch 33, global step 2448: 'g_loss' was not in top 1
Epoch 34, global step 2520: 'g_loss' was not in top 1

Epoch 36:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.03, v_num=chn0, g_loss_step=0.714, d_loss_step=1.350, val_g_loss=0.705, val_d_loss=1.320, g_loss_epoch=0.694, d_loss_epoch=1.370]
Epoch 36, global step 2664: 'g_loss' was not in top 1
Epoch 38:  90%|███████████████████████▍  | 36/40 [00:00<00:00, 61.38it/s, loss=1.03, v_num=chn0, g_loss_step=0.676, d_loss_step=1.420, val_g_loss=0.675, val_d_loss=1.360, g_loss_epoch=0.665, d_loss_epoch=1.390]
Validation: 0it [00:00, ?it/s]
Epoch 38, global step 2808: 'g_loss' was not in top 1
Epoch 39, global step 2880: 'g_loss' was not in top 1

Epoch 40, global step 2952: 'g_loss' was not in top 1
Epoch 41, global step 3024: 'g_loss' was not in top 1

Epoch 44:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.03, v_num=chn0, g_loss_step=0.659, d_loss_step=1.380, val_g_loss=0.668, val_d_loss=1.370, g_loss_epoch=0.667, d_loss_epoch=1.390]
Epoch 43, global step 3168: 'g_loss' was not in top 1
Epoch 44, global step 3240: 'g_loss' was not in top 1
Epoch 46:  90%|███████████████████████▍  | 36/40 [00:00<00:00, 72.94it/s, loss=1.03, v_num=chn0, g_loss_step=0.673, d_loss_step=1.390, val_g_loss=0.669, val_d_loss=1.370, g_loss_epoch=0.668, d_loss_epoch=1.390]
Validation: 0it [00:00, ?it/s]
Epoch 46, global step 3384: 'g_loss' was not in top 1
Epoch 47, global step 3456: 'g_loss' was not in top 1

Epoch 49:  90%|███████████████████████▍  | 36/40 [00:00<00:00, 71.36it/s, loss=1.03, v_num=chn0, g_loss_step=0.648, d_loss_step=1.410, val_g_loss=0.664, val_d_loss=1.380, g_loss_epoch=0.663, d_loss_epoch=1.390]
Validation: 0it [00:00, ?it/s]