GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Process Name: MainProcess, PID: 152768, DataIndex: 300
Process Name: MainProcess, PID: 152768, DataIndex: 600
Process Name: MainProcess, PID: 152768, DataIndex: 900
Process Name: MainProcess, PID: 152768, DataIndex: 1200
Process Name: MainProcess, PID: 152768, DataIndex: 1500
Process Name: MainProcess, PID: 152768, DataIndex: 1800
Process Name: MainProcess, PID: 152768, DataIndex: 2100
Process Name: MainProcess, PID: 152768, DataIndex: 2400
Process Name: MainProcess, PID: 152768, DataIndex: 2700
Process Name: MainProcess, PID: 152768, DataIndex: 3000
Process Name: MainProcess, PID: 152768, DataIndex: 3300
Process Name: MainProcess, PID: 152768, DataIndex: 3600
Process Name: MainProcess, PID: 152768, DataIndex: 3900
Process Name: MainProcess, PID: 152768, DataIndex: 4200
Process Name: MainProcess, PID: 152768, DataIndex: 4500
Process Name: MainProcess, PID: 152768, DataIndex: 4800
Process Name: MainProcess, PID: 152768, DataIndex: 5100
Process Name: MainProcess, PID: 152768, DataIndex: 5400
Process Name: MainProcess, PID: 152768, DataIndex: 5700
Process Name: MainProcess, PID: 152768, DataIndex: 6000
Process Name: MainProcess, PID: 152768, DataIndex: 6300
Process Name: MainProcess, PID: 152768, DataIndex: 6600
Process Name: MainProcess, PID: 152768, DataIndex: 6900
Process Name: MainProcess, PID: 152768, DataIndex: 7200
/home/siyao/Apps/anaconda3/envs/miniGrid/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:611: UserWarning: Checkpoint directory /home/siyao/project/rlPractice/DomainGeneralization/modelBased/gen/models/ckpt exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/siyao/Apps/anaconda3/envs/miniGrid/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
  | Name          | Type          | Params
------------------------------------------------
0 | generator     | Generator     | 826 K
1 | discriminator | Discriminator | 77.7 K
------------------------------------------------
903 K     Trainable params
0         Non-trainable params
903 K     Total params
3.615     Total estimated model params size (MB)
/home/siyao/Apps/anaconda3/envs/miniGrid/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py:1927: PossibleUserWarning: The number of training batches (36) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
Process Name: MainProcess, PID: 152768, DataIndex: 7500
Process Name: MainProcess, PID: 152768, DataIndex: 7800
Process Name: MainProcess, PID: 152768, DataIndex: 8100
Process Name: MainProcess, PID: 152768, DataIndex: 8400
Process Name: MainProcess, PID: 152768, DataIndex: 8700
Process Name: MainProcess, PID: 152768, DataIndex: 9000
Process Name: MainProcess, PID: 152768, DataIndex: 9300
Process Name: MainProcess, PID: 152768, DataIndex: 9600
Process Name: MainProcess, PID: 152768, DataIndex: 9900
Epoch 0:   0%|                                                                                                                                                                             | 0/40 [00:00<?, ?it/s]
Metric g_loss improved. New best score: 0.673
Epoch 0, global step 72: 'g_loss' reached 0.67272 (best 0.67272), saving model to '/home/siyao/project/rlPractice/DomainGeneralization/modelBased/gen/models/ckpt/gen-epoch=00-g_loss=0.6727.ckpt' as top 1

Epoch 2:  70%|██████████████████▉        | 28/40 [00:00<00:00, 61.91it/s, loss=1.02, v_num=mbbh, g_loss_step=1.160, d_loss_step=0.888, val_g_loss=1.320, val_d_loss=0.638, g_loss_epoch=0.878, d_loss_epoch=1.090]
Epoch 2, global step 216: 'g_loss' was not in top 1
Epoch 3, global step 288: 'g_loss' was not in top 1
Metric g_loss improved by 0.185 >= min_delta = 0.01. New best score: 0.487

Epoch 5:  45%|████████████▏              | 18/40 [00:00<00:00, 52.81it/s, loss=0.98, v_num=mbbh, g_loss_step=1.030, d_loss_step=0.843, val_g_loss=0.632, val_d_loss=1.220, g_loss_epoch=0.487, d_loss_epoch=1.630]
Epoch 5, global step 432: 'g_loss' was not in top 1

Epoch 8:  30%|████████                   | 12/40 [00:00<00:00, 40.47it/s, loss=1.13, v_num=mbbh, g_loss_step=0.994, d_loss_step=1.210, val_g_loss=0.430, val_d_loss=2.010, g_loss_epoch=0.860, d_loss_epoch=1.560]
Epoch 7, global step 576: 'g_loss' was not in top 1
Epoch 8, global step 648: 'g_loss' was not in top 1

Epoch 11:   2%|▋                          | 1/40 [00:00<00:06,  5.81it/s, loss=1.08, v_num=mbbh, g_loss_step=0.974, d_loss_step=1.160, val_g_loss=0.886, val_d_loss=1.160, g_loss_epoch=0.996, d_loss_epoch=1.170]
Epoch 10, global step 792: 'g_loss' was not in top 1
Epoch 11, global step 864: 'g_loss' was not in top 1

Epoch 13:  10%|██▋                        | 4/40 [00:00<00:02, 17.74it/s, loss=1.05, v_num=mbbh, g_loss_step=0.796, d_loss_step=1.290, val_g_loss=0.758, val_d_loss=1.310, g_loss_epoch=0.625, d_loss_epoch=1.510]
Epoch 13, global step 1008: 'g_loss' was not in top 1

Epoch 16:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.06, v_num=mbbh, g_loss_step=0.642, d_loss_step=1.450, val_g_loss=0.629, val_d_loss=1.430, g_loss_epoch=0.770, d_loss_epoch=1.330]
Epoch 15, global step 1152: 'g_loss' was not in top 1
Epoch 16, global step 1224: 'g_loss' was not in top 1
Epoch 18:  98%|█████████████████████████▎| 39/40 [00:00<00:00, 57.92it/s, loss=1.01, v_num=mbbh, g_loss_step=0.653, d_loss_step=1.390, val_g_loss=1.030, val_d_loss=1.020, g_loss_epoch=1.090, d_loss_epoch=0.905]
Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 335.66it/s]
Epoch 18, global step 1368: 'g_loss' was not in top 1
Epoch 19, global step 1440: 'g_loss' was not in top 1

Epoch 20, global step 1512: 'g_loss' was not in top 1
Epoch 21, global step 1584: 'g_loss' was not in top 1

Epoch 24:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.05, v_num=mbbh, g_loss_step=0.481, d_loss_step=1.660, val_g_loss=0.467, val_d_loss=1.610, g_loss_epoch=0.607, d_loss_epoch=1.460]
Epoch 23, global step 1728: 'g_loss' was not in top 1
Metric g_loss improved by 0.056 >= min_delta = 0.01. New best score: 0.431
Epoch 24, global step 1800: 'g_loss' reached 0.43127 (best 0.43127), saving model to '/home/siyao/project/rlPractice/DomainGeneralization/modelBased/gen/models/ckpt/gen-epoch=24-g_loss=0.4313.ckpt' as top 1
Epoch 26:  90%|██████████████████████████   | 36/40 [00:00<00:00, 63.18it/s, loss=1, v_num=mbbh, g_loss_step=0.561, d_loss_step=1.450, val_g_loss=0.506, val_d_loss=1.520, g_loss_epoch=0.467, d_loss_epoch=1.600]
Validation: 0it [00:00, ?it/s]
Epoch 26, global step 1944: 'g_loss' was not in top 1

Epoch 27, global step 2016: 'g_loss' was not in top 1
Epoch 28, global step 2088: 'g_loss' was not in top 1
Epoch 29, global step 2160: 'g_loss' was not in top 1

Epoch 31:  40%|██████████▍               | 16/40 [00:00<00:00, 48.38it/s, loss=1.05, v_num=mbbh, g_loss_step=0.439, d_loss_step=1.660, val_g_loss=0.445, val_d_loss=1.640, g_loss_epoch=0.455, d_loss_epoch=1.630]
Epoch 31, global step 2304: 'g_loss' was not in top 1

Epoch 34:  40%|██████████▍               | 16/40 [00:00<00:00, 47.89it/s, loss=1.06, v_num=mbbh, g_loss_step=0.443, d_loss_step=1.650, val_g_loss=0.442, val_d_loss=1.660, g_loss_epoch=0.440, d_loss_epoch=1.670]
Epoch 33, global step 2448: 'g_loss' was not in top 1
Epoch 34, global step 2520: 'g_loss' was not in top 1

Epoch 37:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.06, v_num=mbbh, g_loss_step=0.460, d_loss_step=1.660, val_g_loss=0.461, val_d_loss=1.640, g_loss_epoch=0.455, d_loss_epoch=1.660]
Epoch 36, global step 2664: 'g_loss' was not in top 1
Epoch 37, global step 2736: 'g_loss' was not in top 1

Epoch 40:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.05, v_num=mbbh, g_loss_step=0.494, d_loss_step=1.620, val_g_loss=0.494, val_d_loss=1.600, g_loss_epoch=0.489, d_loss_epoch=1.620]
Epoch 39, global step 2880: 'g_loss' was not in top 1
Epoch 40, global step 2952: 'g_loss' was not in top 1

Epoch 42:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.05, v_num=mbbh, g_loss_step=0.494, d_loss_step=1.590, val_g_loss=0.495, val_d_loss=1.600, g_loss_epoch=0.495, d_loss_epoch=1.610]
Epoch 42, global step 3096: 'g_loss' was not in top 1

Epoch 45:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.05, v_num=mbbh, g_loss_step=0.497, d_loss_step=1.600, val_g_loss=0.496, val_d_loss=1.600, g_loss_epoch=0.496, d_loss_epoch=1.610]
Epoch 44, global step 3240: 'g_loss' was not in top 1
Epoch 45, global step 3312: 'g_loss' was not in top 1
Epoch 47:  90%|███████████████████████▍  | 36/40 [00:00<00:00, 70.83it/s, loss=1.05, v_num=mbbh, g_loss_step=0.499, d_loss_step=1.590, val_g_loss=0.496, val_d_loss=1.600, g_loss_epoch=0.496, d_loss_epoch=1.610]
Validation: 0it [00:00, ?it/s]
Epoch 47, global step 3456: 'g_loss' was not in top 1
Epoch 48, global step 3528: 'g_loss' was not in top 1

Epoch 49, global step 3600: 'g_loss' was not in top 1
Epoch 50, global step 3672: 'g_loss' was not in top 1

Epoch 52:  85%|██████████████████████    | 34/40 [00:00<00:00, 57.54it/s, loss=1.05, v_num=mbbh, g_loss_step=0.502, d_loss_step=1.610, val_g_loss=0.500, val_d_loss=1.600, g_loss_epoch=0.500, d_loss_epoch=1.600]
Epoch 52, global step 3816: 'g_loss' was not in top 1
Epoch 53, global step 3888: 'g_loss' was not in top 1

Epoch 55:  35%|█████████                 | 14/40 [00:00<00:00, 45.96it/s, loss=1.05, v_num=mbbh, g_loss_step=0.500, d_loss_step=1.620, val_g_loss=0.500, val_d_loss=1.600, g_loss_epoch=0.500, d_loss_epoch=1.600]
Epoch 55, global step 4032: 'g_loss' was not in top 1

Epoch 58:   2%|▋                          | 1/40 [00:00<00:07,  5.19it/s, loss=1.05, v_num=mbbh, g_loss_step=0.500, d_loss_step=1.620, val_g_loss=0.500, val_d_loss=1.600, g_loss_epoch=0.500, d_loss_epoch=1.600]
Epoch 57, global step 4176: 'g_loss' was not in top 1
Epoch 58, global step 4248: 'g_loss' was not in top 1

Epoch 61:   0%|                                   | 0/40 [00:00<?, ?it/s, loss=1.05, v_num=mbbh, g_loss_step=0.500, d_loss_step=1.620, val_g_loss=0.500, val_d_loss=1.600, g_loss_epoch=0.500, d_loss_epoch=1.600]
Epoch 60, global step 4392: 'g_loss' was not in top 1
Epoch 61, global step 4464: 'g_loss' was not in top 1

Epoch 63:  80%|████████████████████▊     | 32/40 [00:00<00:00, 62.39it/s, loss=1.05, v_num=mbbh, g_loss_step=0.501, d_loss_step=1.600, val_g_loss=0.500, val_d_loss=1.600, g_loss_epoch=0.501, d_loss_epoch=1.600]
Epoch 63, global step 4608: 'g_loss' was not in top 1
Epoch 65:  90%|███████████████████████▍  | 36/40 [00:00<00:00, 60.48it/s, loss=1.05, v_num=mbbh, g_loss_step=0.502, d_loss_step=1.620, val_g_loss=0.500, val_d_loss=1.600, g_loss_epoch=0.500, d_loss_epoch=1.600]
Validation: 0it [00:00, ?it/s]
Epoch 65, global step 4752: 'g_loss' was not in top 1
Epoch 66, global step 4824: 'g_loss' was not in top 1
Epoch 67, global step 4896: 'g_loss' was not in top 1
Epoch 68, global step 4968: 'g_loss' was not in top 1
Epoch 69, global step 5040: 'g_loss' was not in top 1
Epoch 70, global step 5112: 'g_loss' was not in top 1
Epoch 71, global step 5184: 'g_loss' was not in top 1

Epoch 72, global step 5256: 'g_loss' was not in top 1
Epoch 73, global step 5328: 'g_loss' was not in top 1
Epoch 74, global step 5400: 'g_loss' was not in top 1
Epoch 76:  90%|███████████████████████▍  | 36/40 [00:00<00:00, 65.74it/s, loss=1.05, v_num=mbbh, g_loss_step=0.503, d_loss_step=1.640, val_g_loss=0.501, val_d_loss=1.600, g_loss_epoch=0.501, d_loss_epoch=1.600]
Validation: 0it [00:00, ?it/s]
Epoch 76, global step 5544: 'g_loss' was not in top 1
Epoch 77, global step 5616: 'g_loss' was not in top 1

Epoch 78, global step 5688: 'g_loss' was not in top 1
Epoch 79, global step 5760: 'g_loss' was not in top 1
Epoch 80, global step 5832: 'g_loss' was not in top 1

Epoch 82:  52%|█████████████▋            | 21/40 [00:00<00:00, 56.06it/s, loss=1.05, v_num=mbbh, g_loss_step=0.501, d_loss_step=1.610, val_g_loss=0.501, val_d_loss=1.600, g_loss_epoch=0.501, d_loss_epoch=1.600]
Epoch 82, global step 5976: 'g_loss' was not in top 1

Epoch 85:  25%|██████▌                   | 10/40 [00:00<00:00, 35.32it/s, loss=1.05, v_num=mbbh, g_loss_step=0.501, d_loss_step=1.610, val_g_loss=0.502, val_d_loss=1.600, g_loss_epoch=0.502, d_loss_epoch=1.600]
Epoch 84, global step 6120: 'g_loss' was not in top 1
Epoch 85, global step 6192: 'g_loss' was not in top 1

Epoch 87:  48%|████████████▎             | 19/40 [00:00<00:00, 49.99it/s, loss=1.05, v_num=mbbh, g_loss_step=0.502, d_loss_step=1.600, val_g_loss=0.501, val_d_loss=1.600, g_loss_epoch=0.502, d_loss_epoch=1.600]
Epoch 87, global step 6336: 'g_loss' was not in top 1
Epoch 88, global step 6408: 'g_loss' was not in top 1

Epoch 90:   5%|█▎                         | 2/40 [00:00<00:03, 10.34it/s, loss=1.05, v_num=mbbh, g_loss_step=0.502, d_loss_step=1.600, val_g_loss=0.501, val_d_loss=1.600, g_loss_epoch=0.502, d_loss_epoch=1.600]
Epoch 90, global step 6552: 'g_loss' was not in top 1
Epoch 92:  90%|███████████████████████▍  | 36/40 [00:00<00:00, 55.37it/s, loss=1.05, v_num=mbbh, g_loss_step=0.503, d_loss_step=1.610, val_g_loss=0.502, val_d_loss=1.600, g_loss_epoch=0.502, d_loss_epoch=1.600]
Validation: 0it [00:00, ?it/s]
Epoch 92, global step 6696: 'g_loss' was not in top 1
Epoch 93, global step 6768: 'g_loss' was not in top 1
Epoch 94, global step 6840: 'g_loss' was not in top 1
Epoch 95, global step 6912: 'g_loss' was not in top 1
Epoch 96, global step 6984: 'g_loss' was not in top 1
Epoch 97, global step 7056: 'g_loss' was not in top 1
Epoch 98, global step 7128: 'g_loss' was not in top 1

Epoch 99, global step 7200: 'g_loss' was not in top 1
Epoch 100, global step 7272: 'g_loss' was not in top 1
Epoch 101, global step 7344: 'g_loss' was not in top 1

Epoch 103:  42%|██████████▋              | 17/40 [00:00<00:00, 47.26it/s, loss=1.05, v_num=mbbh, g_loss_step=0.503, d_loss_step=1.600, val_g_loss=0.502, val_d_loss=1.590, g_loss_epoch=0.502, d_loss_epoch=1.600]
Epoch 103, global step 7488: 'g_loss' was not in top 1

Epoch 106:   2%|▋                         | 1/40 [00:00<00:07,  5.28it/s, loss=1.05, v_num=mbbh, g_loss_step=0.502, d_loss_step=1.600, val_g_loss=0.502, val_d_loss=1.590, g_loss_epoch=0.503, d_loss_epoch=1.600]
Epoch 105, global step 7632: 'g_loss' was not in top 1
Epoch 106, global step 7704: 'g_loss' was not in top 1

Epoch 108:  18%|████▌                     | 7/40 [00:00<00:01, 28.77it/s, loss=1.06, v_num=mbbh, g_loss_step=0.502, d_loss_step=1.630, val_g_loss=0.502, val_d_loss=1.590, g_loss_epoch=0.502, d_loss_epoch=1.600]
Epoch 108, global step 7848: 'g_loss' was not in top 1
Epoch 109, global step 7920: 'g_loss' was not in top 1

Epoch 111:   0%|                                  | 0/40 [00:00<?, ?it/s, loss=1.05, v_num=mbbh, g_loss_step=0.504, d_loss_step=1.590, val_g_loss=0.502, val_d_loss=1.590, g_loss_epoch=0.502, d_loss_epoch=1.600]
Epoch 111, global step 8064: 'g_loss' was not in top 1
Epoch 113:  90%|██████████████████████▌  | 36/40 [00:00<00:00, 61.64it/s, loss=1.05, v_num=mbbh, g_loss_step=0.501, d_loss_step=1.620, val_g_loss=0.503, val_d_loss=1.590, g_loss_epoch=0.503, d_loss_epoch=1.600]
Validation: 0it [00:00, ?it/s]
Epoch 113, global step 8208: 'g_loss' was not in top 1
Epoch 114, global step 8280: 'g_loss' was not in top 1

Epoch 115, global step 8352: 'g_loss' was not in top 1
Epoch 116, global step 8424: 'g_loss' was not in top 1
Epoch 118:  90%|██████████████████████▌  | 36/40 [00:00<00:00, 61.52it/s, loss=1.05, v_num=mbbh, g_loss_step=0.504, d_loss_step=1.580, val_g_loss=0.502, val_d_loss=1.590, g_loss_epoch=0.503, d_loss_epoch=1.600]
Validation: 0it [00:00, ?it/s]
Epoch 118, global step 8568: 'g_loss' was not in top 1
Epoch 119, global step 8640: 'g_loss' was not in top 1

Epoch 120, global step 8712: 'g_loss' was not in top 1
Epoch 121, global step 8784: 'g_loss' was not in top 1

Epoch 124:   8%|█▉                        | 3/40 [00:00<00:02, 13.45it/s, loss=1.05, v_num=mbbh, g_loss_step=0.502, d_loss_step=1.600, val_g_loss=0.503, val_d_loss=1.590, g_loss_epoch=0.503, d_loss_epoch=1.600]
Epoch 123, global step 8928: 'g_loss' was not in top 1
Monitored metric g_loss did not improve in the last 100 records. Best score: 0.431. Signaling Trainer to stop.

Epoch 124: 100%|█████████████████████████| 40/40 [00:00<00:00, 58.45it/s, loss=1.05, v_num=mbbh, g_loss_step=0.503, d_loss_step=1.590, val_g_loss=0.503, val_d_loss=1.590, g_loss_epoch=0.503, d_loss_epoch=1.600]
[34m[1mwandb[39m[22m: [33mWARNING[39m Saving files without folders. If you want to preserve subdirectories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")